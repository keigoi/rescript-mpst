// Generated by ReScript, PLEASE EDIT WITH CARE

import * as List from "rescript/lib/es6/list.js";
import * as Curry from "rescript/lib/es6/curry.js";
import * as Raw$RescriptMpst from "./Raw.js";
import * as RawTransport$RescriptMpst from "./RawTransport.js";

function lens_a_get(param) {
  return param[0];
}

function lens_a_put(param, a) {
  return [
          a,
          param[1],
          param[2]
        ];
}

var lens_a = {
  get: lens_a_get,
  put: lens_a_put
};

function lens_b_get(param) {
  return param[1];
}

function lens_b_put(param, b) {
  return [
          param[0],
          b,
          param[2]
        ];
}

var lens_b = {
  get: lens_b_get,
  put: lens_b_put
};

function lens_c_get(param) {
  return param[2];
}

function lens_c_put(param, c) {
  return [
          param[0],
          param[1],
          c
        ];
}

var lens_c = {
  get: lens_c_get,
  put: lens_c_put
};

var alice_role_label = {
  closed_match: (function (param) {
      return param.VAL;
    }),
  closed_make: (function (v) {
      return {
              NAME: "Alice",
              VAL: v
            };
    })
};

var alice = {
  role_label: alice_role_label,
  role_lens: lens_a
};

var bob_role_label = {
  closed_match: (function (param) {
      return param.VAL;
    }),
  closed_make: (function (v) {
      return {
              NAME: "Bob",
              VAL: v
            };
    })
};

var bob = {
  role_label: bob_role_label,
  role_lens: lens_b
};

var carol_role_label = {
  closed_match: (function (param) {
      return param.VAL;
    }),
  closed_make: (function (v) {
      return {
              NAME: "Carol",
              VAL: v
            };
    })
};

var carol = {
  role_label: carol_role_label,
  role_lens: lens_c
};

var hello_label_closed = {
  closed_match: (function (param) {
      return param.VAL;
    }),
  closed_make: (function (v) {
      return {
              NAME: "hello",
              VAL: v
            };
    })
};

function hello_label_open(v) {
  return {
          NAME: "hello",
          VAL: v
        };
}

var hello = {
  label_closed: hello_label_closed,
  label_open: hello_label_open
};

var goodbye_label_closed = {
  closed_match: (function (param) {
      return param.VAL;
    }),
  closed_make: (function (v) {
      return {
              NAME: "goodbye",
              VAL: v
            };
    })
};

function goodbye_label_open(v) {
  return {
          NAME: "goodbye",
          VAL: v
        };
}

var goodbye = {
  label_closed: goodbye_label_closed,
  label_open: goodbye_label_open
};

function list_match(param, param$1) {
  return Raw$RescriptMpst.assertfalse(undefined);
}

function hello_or_goodbye_concat(l, r) {
  return {
          hd: {
            NAME: "hello",
            VAL: Raw$RescriptMpst.assertfalse(undefined)
          },
          tl: {
            hd: {
              NAME: "goodbye",
              VAL: Raw$RescriptMpst.assertfalse(undefined)
            },
            tl: /* [] */0
          }
        };
}

function hello_or_goodbye_split(lr) {
  return [
          {
            hd: {
              NAME: "hello",
              VAL: Raw$RescriptMpst.assertfalse(undefined)
            },
            tl: /* [] */0
          },
          {
            hd: {
              NAME: "goodbye",
              VAL: Raw$RescriptMpst.assertfalse(undefined)
            },
            tl: /* [] */0
          }
        ];
}

var hello_or_goodbye = {
  concat: hello_or_goodbye_concat,
  split: hello_or_goodbye_split
};

function to_bob(disj) {
  return {
          concat: (function (l, r) {
              return List.map((function (v) {
                            return {
                                    NAME: "Bob",
                                    VAL: {
                                      __out_witness: v
                                    }
                                  };
                          }), Curry._2(disj.concat, List.map((function (param) {
                                    return param.VAL.__out_witness;
                                  }), l), List.map((function (param) {
                                    return param.VAL.__out_witness;
                                  }), r)));
            }),
          split: (function (lr) {
              var match = Curry._1(disj.split, List.map((function (param) {
                          return param.VAL.__out_witness;
                        }), lr));
              return [
                      List.map((function (v) {
                              return {
                                      NAME: "Bob",
                                      VAL: {
                                        __out_witness: v
                                      }
                                    };
                            }), match[0]),
                      List.map((function (v) {
                              return {
                                      NAME: "Bob",
                                      VAL: {
                                        __out_witness: v
                                      }
                                    };
                            }), match[1])
                    ];
            })
        };
}

function role_to_tag(role) {
  return Raw$RescriptMpst.destruct_polyvar(Curry._1(role.role_label.closed_make, Raw$RescriptMpst.dontknow(undefined)))[0];
}

function open_variant_to_tag($$var) {
  return Raw$RescriptMpst.destruct_polyvar(Curry._1($$var, Raw$RescriptMpst.dontknow(undefined)))[0];
}

function send(sess, role, label, v) {
  var roletag = open_variant_to_tag(role);
  var labeltag = open_variant_to_tag(label);
  RawTransport$RescriptMpst.raw_send(sess.mpchan, roletag, labeltag, v);
  return {
          dummy_witness: Raw$RescriptMpst.dontknow(undefined),
          mpchan: sess.mpchan
        };
}

function receive(sess, role) {
  var roletag = open_variant_to_tag(role);
  return RawTransport$RescriptMpst.raw_receive(sess.mpchan, roletag).then(function (param) {
              var cont_dummy_witness = Raw$RescriptMpst.dontknow(undefined);
              var cont_mpchan = sess.mpchan;
              var cont = {
                dummy_witness: cont_dummy_witness,
                mpchan: cont_mpchan
              };
              return Raw$RescriptMpst.make_polyvar(param[0], [
                          param[1],
                          cont
                        ]);
            });
}

function close(param) {
  
}

function $neg$neg$great(_from, _to, _label, _next) {
  return Raw$RescriptMpst.dontknow(undefined);
}

var finish = Raw$RescriptMpst.dontknow(undefined);

function choice_at(_alice, _disj, param, param$1) {
  return Raw$RescriptMpst.dontknow(undefined);
}

function extract(_g, _role) {
  return Raw$RescriptMpst.todo(undefined);
}

var g = choice_at(alice, to_bob(hello_or_goodbye), [
      alice,
      (Raw$RescriptMpst.dontknow(undefined), Raw$RescriptMpst.dontknow(undefined), Raw$RescriptMpst.dontknow(undefined))
    ], [
      alice,
      (Raw$RescriptMpst.dontknow(undefined), Raw$RescriptMpst.dontknow(undefined))
    ]);

function a(param) {
  var ch = Raw$RescriptMpst.todo(undefined);
  var ch$1 = send(ch, (function (x) {
          return {
                  NAME: "Bob",
                  VAL: x
                };
        }), (function (x) {
          return {
                  NAME: "hello",
                  VAL: x
                };
        }), 123);
  return receive(ch$1, (function (x) {
                  return {
                          NAME: "Carol",
                          VAL: x
                        };
                })).then(function (param) {
              
            });
}

function b(param) {
  var ch = Raw$RescriptMpst.todo(undefined);
  return receive(ch, (function (x) {
                  return {
                          NAME: "Alice",
                          VAL: x
                        };
                })).then(function (ret) {
              if (ret.NAME === "hello") {
                send(ret.VAL[1], (function (x) {
                        return {
                                NAME: "Carol",
                                VAL: x
                              };
                      }), (function (x) {
                        return {
                                NAME: "hello",
                                VAL: x
                              };
                      }), 123);
              } else {
                send(ret.VAL[1], (function (x) {
                        return {
                                NAME: "Carol",
                                VAL: x
                              };
                      }), (function (x) {
                        return {
                                NAME: "goodbye",
                                VAL: x
                              };
                      }), "foo");
              }
              
            });
}

function c(param) {
  var ch = Raw$RescriptMpst.todo(undefined);
  return receive(ch, (function (x) {
                  return {
                          NAME: "Bob",
                          VAL: x
                        };
                })).then(function (ret) {
              if (ret.NAME === "hello") {
                send(ret.VAL[1], (function (x) {
                        return {
                                NAME: "Alice",
                                VAL: x
                              };
                      }), (function (x) {
                        return {
                                NAME: "hello",
                                VAL: x
                              };
                      }), 123);
              } else {
                ret.VAL[1];
              }
              
            });
}

var x = 1;

export {
  lens_a ,
  lens_b ,
  lens_c ,
  alice ,
  bob ,
  carol ,
  hello ,
  goodbye ,
  list_match ,
  hello_or_goodbye ,
  to_bob ,
  role_to_tag ,
  open_variant_to_tag ,
  send ,
  receive ,
  close ,
  x ,
  $neg$neg$great ,
  finish ,
  choice_at ,
  extract ,
  g ,
  a ,
  b ,
  c ,
  
}
/* finish Not a pure module */
